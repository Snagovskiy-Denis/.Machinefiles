# Defaults: Mod1=<Alt>, Mod4=<Super>
# My xmonadmap Mod3=<Space>
set $mod Mod3
set $terminal i3-sensible-terminal


########################################
########		Workspaces		########
########################################
#  
workspace_auto_back_and_forth yes

set $ws1  "1  "
set $ws2  "2 爵 "
set $ws3  "3  "
set $ws4  "4"
set $ws5  "5"
set $ws6  "6"
set $ws7  "7  "
set $ws8  "8  "
set $ws9  "9"
set $ws10 "10 ﴣ "

# switch to workspace
bindsym $mod+1 workspace  $ws1; bar mode dock bar-1
bindsym $mod+2 workspace  $ws2; bar mode hide bar-1  # auto-hide bar on ws2
bindsym $mod+3 workspace  $ws3; bar mode dock bar-1
bindsym $mod+4 workspace  $ws4; bar mode dock bar-1
bindsym $mod+5 workspace  $ws5; bar mode dock bar-1
bindsym $mod+6 workspace  $ws6; bar mode dock bar-1
bindsym $mod+7 workspace  $ws7; bar mode dock bar-1
bindsym $mod+8 workspace  $ws8; bar mode hide bar-1  # auto-hide bar on ws8
bindsym $mod+9 workspace  $ws9; bar mode dock bar-1
bindsym $mod+0 workspace $ws10; bar mode dock bar-1

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8
bindsym $mod+Shift+9 move container to workspace $ws9
bindsym $mod+Shift+0 move container to workspace $ws10


########################################
########		Aesthetics		########
########################################

# Window border style: normal: border normal, with window title bar;
# none: no border or window title bar; 1pixel: 1 pixel border.
new_window pixel 1
new_float normal

# font for window titles
font pango:Hack Nerd Font 12

# Orientation for new workspaces
# Can be set <horizontal|vertical|auto>
default_orientation horizontal

# Layout for new containers
# Can be set <default|stacking|tabbed>
workspace_layout default

# class                 border  backgr. text    indicator child_border
client.focused          #8c0d0b #285577 #ffffff #2e9ef4   #8c0d0b
client.focused_inactive #333333 #5f676a #ffffff #484e50   #5f676a
client.unfocused        #333333 #222222 #888888 #292d2e   #222222
client.urgent           #2f343a #900000 #ffffff #900000   #900000
client.placeholder      #000000 #0c0c0c #ffffff #000000   #0c0c0c

client.background       #ffffff


########################################
########		Keybindings		########
########################################

# To find codes for special keys:
# xmodmap -pk | grep -i XF86

###########
# Windows #
###########

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# kill focused window
bindsym $mod+Shift+c kill

# split in horizontal orientation
bindsym $mod+v split h

# split in vertical orientation
bindsym $mod+s split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# toggle tiling / floating
# p for "pop-up"
bindsym $mod+Shift+p floating toggle

# change focus between tiling / floating windows
bindsym $mod+p focus mode_toggle


#########
# Mods #
#########

bindsym $mod+r mode         "resize"
bindsym $mod+d mode         "favorite"
bindsym $mod+a mode         "audio"
bindsym $mod+semicolon mode "layout"

# keycode 108 = Right Alt
bindcode  108  mode         "writing"


# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym h resize shrink width  10 px or 10 ppt
        bindsym j resize grow   height 10 px or 10 ppt
        bindsym k resize shrink height 10 px or 10 ppt
        bindsym l resize grow   width  10 px or 10 ppt

        # same bindings, but for the arrow keys
        bindsym Left  resize shrink width  10 px or 10 ppt
        bindsym Down  resize grow   height 10 px or 10 ppt
        bindsym Up    resize shrink height 10 px or 10 ppt
        bindsym Right resize grow   width  10 px or 10 ppt

        # back to normal: Enter or Escape or $mod+r
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+r mode "default"
}

# open favorite application or execute favorite script
mode "favorite" {

        # launcher (duplicate $mod+Shift+Return)
        bindsym Return exec "rofi -modi drun,run -show drun" ; mode "default"

        # GUI applications
        bindsym w exec vivaldi-stable                        ; mode "default"
        bindsym d exec gnome-dictionary                      ; mode "default"
        bindsym o exec obsidian                              ; mode "default"

        # CLI & TUI applications
        bindsym r exec $terminal -e ranger                   ; mode "default"
        bindsym n exec $terminal -e nvim                     ; mode "default"
        bindsym m exec $terminal -e cmus                     ; mode "default"
        bindsym t exec $terminal -e taskwarrior-tui          ; mode "default"
        bindsym p exec $terminal -e ipython                  ; mode "default"
        bindsym h exec $terminal -e htop                     ; mode "default"

        # scripts
        bindsym j exec $terminal -e oj                       ; mode "default"
        bindsym f exec $terminal -e dmconf                   ; mode "default"
        # TODO: dmenu passwords (pass) picker

        # back to normal: Escape or $mod+d
        bindsym Escape mode "default"
        bindsym $mod+d mode "default"
}

# control PulseAudio, cmus and playerctl
mode "audio" {

        # back to normal: Enter or Escape or $mod+Shift+a
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+a mode "default"
}


# change container layout
mode "layout" {

        bindsym q layout stacking
        bindsym w layout tabbed
        bindsym e layout toggle split

        # focus the parent container
        bindsym a focus parent

        # focus the child container
        bindsym d focus child

        # toggle tiling / floating
        # p for "pop-up"
        # duplicate for $mod+Shift+p
        bindsym Shift+p floating toggle

        # duplicate for $mod+p
        bindsym p focus mode_toggle

        # move focused window
        # duplicate for $mod+Shift+[hjkl]
        bindsym h move left
        bindsym j move down
        bindsym k move up
        bindsym l move right

        # back to normal: Enter or Escape or $mod+; (semicolon)
        bindsym Return         mode "default"
        bindsym Escape         mode "default"
        bindsym $mod+semicolon mode "default"
}


# exit from default mode and free all keys
mode "writing" {
        # Useful in games or in case of dzen-typing

        bindsym $mod+Left  focus left
        bindsym $mod+Down  focus down
        bindsym $mod+Up    focus up
        bindsym $mod+Right focus right

        # back to normal: Right Alt
        bindcode 108 mode "default"
}


#########
# Audio #
#########

bindsym XF86AudioRaiseVolume exec pamixer --increase 10
bindsym XF86AudioLowerVolume exec pamixer --decrease 10
bindsym XF86AudioMute        exec pamixer --toggle-mute
#bindsym XF86AudioMicMute     exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle

# cmus
# keycode 172 = 懶  (play_pause)    = XF86AudioPlay = XF86AudioPause
# keycode 174 = 栗  (stop)          = XF86AudioStop = XF86AudioEject 
# keycode 173 = 玲  (skip_previous)
# keycode 171 = 怜  (skip_next)
# keycode 179 =    (music)
bindcode 172 exec "cmus-remote --pause"
bindcode 174 exec "cmus-remote --stop"
bindcode 173 exec "cmus-remote --prev"
bindcode 171 exec "cmus-remote --next"
#bindcode 179 exec ""


#########
# Other #
#########

# start a terminal
bindsym $mod+Return exec $terminal

# start rofi
bindsym $mod+Shift+Return exec "rofi -modi drun,run -show drun"

# run shell command (keycode 68 = <F2>)
bindcode $mod+68 exec bash -c "$(rofi -dmenu -p 'Run command:')"

# reload the configuration file (keycode 67 = <F1>)
bindcode $mod+67 reload

# restart i3 inplace (keycode 71 = <F5>, can be used to upgrade i3)
bindcode $mod+71 restart

# exit i3
bindsym $mod+Shift+x exec dmprompt "Are you sure you want to exit i3?" "i3-msg exit"

# jump to urgent window (keycode 69 = <F3>)
bindcode $mod+69 [urgent=latest] focus

# TODO: screenshot & screencast (gh repo in browser inbox)

# TODO: emoji selector

# TODO: look at keypirinha...

# keycode 148 =    (calculator)
# keycode 152 =    (desktokp)
# keycode 163 =    (mail)
# keycode 180 = ﮟ   (home)
bindcode 148 exec gnome-calculator
#bindcode 152 exec ""
#bindcode 163 exec ""
#bindcode 180 exec ""


#######
# Bar #
#######
bar {
        id bar-1
        status_command          i3blocks -c ~/.config/i3/i3blocks.conf
        i3bar_command           i3bar --transparency
        position                top
        font                    pango:Hack Nerd Font 12
        strip_workspace_numbers yes
}

# toggle bar mode <hide|show>
bindsym $mod+m bar mode toggle


########################################
########		Autostart		########
########################################
# ws1
exec --no-startup-id i3-msg "workspace $ws1"
exec --no-startup-id i3-msg "exec $terminal -e oj"
exec --no-startup-id i3-msg "exec $terminal -e taskwarrior-tui"
exec bash -c "sleep 5"
# ws2
exec --no-startup-id i3-msg "workspace $ws2"
exec --no-startup-id i3-msg "exec vivaldi-stable"
exec bash -c "sleep 5"
# ws8
exec --no-startup-id i3-msg "workspace $ws8"
exec --no-startup-id i3-msg "exec $terminal -e cmus"
exec bash -c "sleep 5"
#exec --no-startup-id i3-msg "exec $terminal -e bash -c sleep 5"

# xss-lock grabs a logind suspend inhibit lock and will use i3lock to lock the
# screen before suspend. Use loginctl lock-session to lock your screen.
exec --no-startup-id xss-lock --transfer-sleep-lock -- i3lock --nofork
